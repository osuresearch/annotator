"use strict";(self.webpackChunk_osuresearch_annotator=self.webpackChunk_osuresearch_annotator||[]).push([[805],{"./src/components/ExternalDocument/ExternalDocument.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AlignmentTest:()=>AlignmentTest,Simple:()=>Simple,StressTest:()=>StressTest,__namedExportsOrder:()=>__namedExportsOrder,default:()=>ExternalDocument_stories});var react=__webpack_require__("./node_modules/react/index.js"),index_module=__webpack_require__("./node_modules/@osuresearch/ui/dist/index.module.js"),lib=__webpack_require__("./node_modules/react-frame-component/lib/index.js"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),react_dom=__webpack_require__("./node_modules/react-dom/index.js"),dist=__webpack_require__("./node_modules/@tiptap/react/dist/index.js"),starter_kit_dist=__webpack_require__("./node_modules/@tiptap/starter-kit/dist/index.js"),v4=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js"),dist_import=__webpack_require__("./node_modules/@react-stately/data/dist/import.mjs");const AnnotationsContext=(0,react.createContext)({});function useAnnotationsContext(){return(0,react.useContext)(AnnotationsContext)}function getDocumentPosition(el){const doc=el.ownerDocument,win=doc.defaultView;if(!win)return{top:-1,left:-1};const rect=el.getBoundingClientRect(),scrollLeft=win.scrollX||doc.documentElement.scrollLeft,scrollTop=win.scrollY||doc.documentElement.scrollTop;return{top:Math.round(rect.top+scrollTop),left:Math.round(rect.left+scrollLeft)}}function getTargetTextPosition(annotation){const selector=annotation.target.selector;return"TextPositionSelector"===selector?.type?{from:selector.start,to:selector.end}:"FragmentSelector"===selector?.type&&"TextPositionSelector"===selector.refinedBy?.type?{from:selector.refinedBy.start,to:selector.refinedBy.end}:{from:0,to:0}}const Context=(0,react.createContext)({});function useAnchorsContext(){return(0,react.useContext)(Context)}const AnnotationPickerContext=(0,react.createContext)({});function useAnnotationPicker(){return(0,react.useContext)(AnnotationPickerContext)}var core_dist=__webpack_require__("./node_modules/@tiptap/core/dist/index.js");const Comment=core_dist.vc.create({name:"comment",addOptions:()=>({HTMLAttributes:{}}),addAttributes:()=>({comment:{default:null,parseHTML:el=>el.getAttribute("data-comment"),renderHTML:attrs=>({"data-comment":attrs.comment})},color:{default:"#bb0000",parseHTML:el=>el.getAttribute("data-comment-color"),renderHTML:attrs=>({"data-comment-color":attrs.color})}}),parseHTML:()=>[{tag:"comment-view[data-comment]",getAttrs:el=>!!el.getAttribute("data-comment")?.trim()&&null}],renderHTML({HTMLAttributes}){return["comment-view",(0,core_dist.P1)(this.options.HTMLAttributes,HTMLAttributes),0]},onCreate(){},addStorage:()=>({users:[]}),addCommands:()=>({setComment:comment=>({commands})=>commands.setMark("comment",{comment,color:"green"}),toggleComment:()=>({commands})=>commands.toggleMark("comment"),unsetComment:()=>({commands})=>commands.unsetMark("comment")})}),CommentFocus=core_dist.vc.create({name:"comment-focus",addOptions:()=>({HTMLAttributes:{}}),addAttributes:()=>({comment:{default:null,parseHTML:el=>el.getAttribute("data-comment"),renderHTML:attrs=>({"data-comment":attrs.comment})}}),parseHTML:()=>[{tag:"comment-view[data-comment]",getAttrs:el=>!!el.getAttribute("data-comment")?.trim()&&null}],renderHTML({HTMLAttributes}){return["comment-focus-view",(0,core_dist.P1)(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:()=>({setCommentFocus:comment=>({commands})=>commands.setMark("comment-focus",{comment}),toggleCommentFocus:()=>({commands})=>commands.toggleMark("comment-focus"),unsetCommentFocus:()=>({commands})=>commands.unsetMark("comment-focus")})});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const AnnotatedTextField=(0,react.forwardRef)((({name,content},ref)=>{const{window}=(0,lib.xQ)(),{select}=useAnnotationPicker(),{annotations,focused,focus}=useAnnotationsContext(),trackedAnnotations=function filterAnnotations(annotations,source,includeDeleted,includeResolved){return annotations.filter((t=>{const selector=t.target.selector;if("FragmentSelector"!==selector?.type||selector.value!==source)return!1;const thread=t.body.find((b=>"Thread"===b.type)),reply=t.body.find((b=>"ThreadReply"===b.type));return!(!includeDeleted&&thread?.deleted||reply?.deleted||!includeResolved&&thread?.resolved)}))}(annotations,name,!0,!0),editor=(0,dist.jE)({extensions:[starter_kit_dist.Z.configure({history:!1}),Comment.configure({}),CommentFocus.configure({})],onSelectionUpdate:({editor})=>{const{from,to,empty,$from,$head,$anchor}=editor.state.selection,mark=editor.isActive("comment");if(!editor.isActive("comment-focus"))if(!empty&&to-from>1){const fromPos=editor.view.coordsAtPos(from);select({targetField:name,type:"highlight",top:fromPos.top+(window?.scrollY??0),start:from,end:to})}else if(mark&&editor.isFocused){const id=editor.getAttributes("comment").comment;focus(id)}},editorProps:{attributes:{spellcheck:"false",tabindex:"0"}},content,editable:!1}),hasFocusedAnnotation="FragmentSelector"===focused?.target.selector?.type&&focused.target.selector.value===name;return function useTiptapAnnotations(source,editor,annotations,focused){const annotationCount=(0,react.useRef)(0),focusId=(0,react.useRef)(void 0),{addAnchors}=useAnchorsContext();(0,react.useEffect)((()=>{if(!editor)return;const redrawMarks=()=>{const commands=editor.chain().selectAll().unsetComment().unsetCommentFocus();if(annotations.forEach((t=>{if(!t.body)return void console.error(t);const{deleted,resolved}=t.body.find((b=>"Thread"===b.type));deleted||resolved||commands.setTextSelection(getTargetTextPosition(t)).setComment(t.id)})),focused){const{deleted}=focused.body.find((b=>"Thread"===b.type));deleted||commands.setTextSelection(getTargetTextPosition(focused)).setCommentFocus(focused.id)}commands.setTextSelection(0).run();const anchors=[];editor.view.dom.querySelectorAll("comment-view").forEach((el=>{const pos=getDocumentPosition(el);anchors.push({id:el.dataset.comment,type:"tmp",source,target:{x:pos.left,y:pos.top,width:0,height:0}})})),console.log("new anchors",anchors),addAnchors(anchors)};if(annotations.length!==annotationCount.current)return annotationCount.current=annotations.length,void redrawMarks();focusId.current!==focused?.id&&(focusId.current=focused?.id,redrawMarks())}),[editor,annotations,annotationCount,focusId,focused,addAnchors])}(name,editor,trackedAnnotations,hasFocusedAnnotation?focused:void 0),(0,jsx_runtime.jsx)("div",{ref,children:(0,jsx_runtime.jsx)(dist.kg,{editor})})}));try{AnnotatedTextField.displayName="AnnotatedTextField",AnnotatedTextField.__docgenInfo={description:"A reviewable element can contain multiple selection ranges,\neach tied to a comment thread.\n\nNew threads can be added created by selecting new ranges,\nand clicking a range associated with a thread will focus\nthat thread for the user to interact with.\n\nTODO: Break this component down more. Anchor is a good candidate for some of this\n(at least the positioning pieces)\n\nNOTE: Don't need forwardRef anymore",displayName:"AnnotatedTextField",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/AnnotatedTextField/AnnotatedTextField.tsx#AnnotatedTextField"]={docgenInfo:AnnotatedTextField.__docgenInfo,name:"AnnotatedTextField",path:"src/components/AnnotatedTextField/AnnotatedTextField.tsx#AnnotatedTextField"})}catch(__react_docgen_typescript_loader_error){}function _HighlightAnchor({source}){const{document}=(0,lib.xQ)(),[target,setTarget]=(0,react.useState)(),[dom,setDOM]=(0,react.useState)();return(0,react.useEffect)((()=>{if(!document)return;const el=document.getElementById(source);el&&(setTarget(el),setDOM(el.innerHTML),el.innerHTML="")}),[document,source]),dom&&document?target?(0,react_dom.createPortal)((0,jsx_runtime.jsx)(AnnotatedTextField,{name:source,content:dom}),target):null:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}const HighlightAnchor=(0,react.memo)(_HighlightAnchor);try{HighlightAnchor.displayName="HighlightAnchor",HighlightAnchor.__docgenInfo={description:"",displayName:"HighlightAnchor",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"highlight"'},{value:'"note"'},{value:'"tmp"'}]}},source:{defaultValue:null,description:"",name:"source",required:!0,type:{name:"string"}},target:{defaultValue:null,description:"Target rect in the document to anchor *to*",name:"target",required:!0,type:{name:"Rect"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ExternalDocument/HighlightAnchor.tsx#HighlightAnchor"]={docgenInfo:HighlightAnchor.__docgenInfo,name:"HighlightAnchor",path:"src/components/ExternalDocument/HighlightAnchor.tsx#HighlightAnchor"})}catch(__react_docgen_typescript_loader_error){}var parse_hotkey=__webpack_require__("./node_modules/@mantine/hooks/esm/use-hotkeys/parse-hotkey.js");const NotesButton=styled_components_browser_esm.ZP.button`
  border-radius: 3px;
  background: white;
  color: black;
  border: 1px solid grey;
  border-radius: 0;
  padding: 4px;
  margin: 4px;

  z-index: 999;

  // TODO: Deal with positioning. I can't guarantee a parent isn't
  // a relative position or not. I'd *like* these to be document-absolute,
  // but that means they can't be children of the target in the DOM.
  position: absolute;
  right: 0;
  display: none;

  &:hover {
    background: grey;
    cursor: pointer;
  }

  /* &[data-selected] {
    background: yellow;
  } */

  &[data-focused] {
    background: yellow;
  }

  &[data-threads] {
    display: block;
  }
`;function NoteAnchorImpl({anchor,el}){const{threads,isFocused,create,focusNext}=function useThreads(source,includeResolved=!1){const{annotations,focused,createThread,focus}=useAnnotationsContext(),[threads,setThreads]=(0,react.useState)([]);(0,react.useEffect)((()=>{const visible=annotations.filter((t=>{const selector=t.target.selector;if("FragmentSelector"!==selector?.type||selector.value!==source)return!1;const{deleted,resolved}=t.body.find((b=>"Thread"===b.type));return!deleted&&(!resolved||includeResolved)}));threads.length===visible.length&&threads.every(((t,i)=>t.id===visible[i].id))||setThreads(visible)}),[annotations,source,threads,includeResolved]);const isFocused=!!focused&&threads.findIndex((t=>t.id===focused.id))>=0;return{threads,isFocused,create:(motivation,selector)=>createThread(motivation,selector),focus:thread=>focus(thread.id),focusNext:()=>{if(!(threads.length<1)){if(!isFocused||focused)for(let i=0;i<threads.length;i++)if(threads[i].id===focused?.id&&i<threads.length-1)return void focus(threads[i+1].id);focus(threads[0].id)}}}}(anchor.source);!function useAnnotationFocus(source,type,el){const{window}=(0,lib.xQ)(),{selected,select}=useAnnotationPicker();return(0,react.useEffect)((()=>{const onFocus=e=>{const rect=e.target.getBoundingClientRect();select({targetField:source,type,top:rect.top+(window?.scrollY??0)})},onBlur=()=>{selected?.targetField===source&&select(void 0)};return el.tabIndex=0,el.addEventListener("focus",onFocus),el.addEventListener("blur",onBlur),()=>{el.removeEventListener("focus",onFocus),el.removeEventListener("blur",onBlur)}}),[el,source,type,selected,select,window]),{isFocused:selected?.targetField===source}}(anchor.source,"note",el),(0,react.useEffect)((()=>{const handler=(0,parse_hotkey.yr)([["mod+alt+M",()=>{create("commenting",{type:"FragmentSelector",value:""})}]]);return el.addEventListener("keydown",handler),()=>el.removeEventListener("keydown",handler)}),[el,create]);return(0,react_dom.createPortal)((0,jsx_runtime.jsxs)(NotesButton,{onClick:e=>{focusNext(),e.preventDefault()},"data-focused":isFocused?"true":void 0,"data-threads":threads.length>0?threads.length:void 0,children:["ðŸ“ ",threads.length]}),el)}function NoteAnchor(anchor){const{document}=(0,lib.xQ)(),[target,setTarget]=(0,react.useState)(),{addAnchors}=useAnchorsContext(),position=function useElementPosition(ref){const[rect,setRect]=(0,react.useState)((()=>{if(ref){const position=getDocumentPosition(ref);return{x:Math.round(position.left),y:Math.round(position.top),width:Math.round(ref.clientWidth),height:Math.round(ref.clientHeight)}}return{x:0,y:0,width:0,height:0}}));return(0,react.useEffect)((()=>{if(!ref)return;let prev=rect;const handle=setInterval((()=>{const position=getDocumentPosition(ref),r={x:Math.round(position.left),y:Math.round(position.top),width:Math.round(ref.clientWidth),height:Math.round(ref.clientHeight)};r.x===prev.x&&r.y===prev.y&&r.width===prev.width&&r.height===prev.height||(console.log("POSITION",r,prev),prev=r,setRect(r))}),1e3);return()=>clearInterval(handle)}),[ref]),rect}(target);return(0,react.useEffect)((()=>{console.log("update position",anchor,position),addAnchors([{...anchor,target:position}])}),[anchor,position]),(0,react.useEffect)((()=>{setTarget(document?.getElementById(anchor.source)??void 0)}),[anchor.source,document]),target?(0,jsx_runtime.jsx)(NoteAnchorImpl,{anchor,el:target}):null}NoteAnchor.displayName="NoteAnchor";try{NoteAnchor.displayName="NoteAnchor",NoteAnchor.__docgenInfo={description:"",displayName:"NoteAnchor",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"highlight"'},{value:'"note"'},{value:'"tmp"'}]}},source:{defaultValue:null,description:"",name:"source",required:!0,type:{name:"string"}},target:{defaultValue:null,description:"Target rect in the document to anchor *to*",name:"target",required:!0,type:{name:"Rect"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ExternalDocument/NoteAnchor.tsx#NoteAnchor"]={docgenInfo:NoteAnchor.__docgenInfo,name:"NoteAnchor",path:"src/components/ExternalDocument/NoteAnchor.tsx#NoteAnchor"})}catch(__react_docgen_typescript_loader_error){}function _Controller(){const{document}=(0,lib.xQ)(),{items,addAnchors}=useAnchorsContext();return document?((0,react.useEffect)((()=>{if(!document)return;const anchors=[];document.querySelectorAll("[data-comment-block]").forEach((el=>{const pos=getDocumentPosition(el);anchors.push({type:"note",source:el.id,target:{x:pos.left,y:pos.top,width:0,height:0}})})),document.querySelectorAll("[data-comment-inline]").forEach((el=>{const pos=getDocumentPosition(el);anchors.push({type:"highlight",source:el.id,target:{x:pos.left,y:pos.top,width:0,height:0}})})),addAnchors(anchors)}),[document]),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(styled_components_browser_esm.LC,{target:document.head,children:(0,jsx_runtime.jsx)("div",{children:items.filter((a=>"tmp"!==a.type)).map((anchor=>"highlight"===anchor.type?(0,jsx_runtime.jsx)(HighlightAnchor,{...anchor},anchor.id):(0,jsx_runtime.jsx)(NoteAnchor,{...anchor},anchor.id)))})})})):null}_Controller.displayName="_Controller";const Controller=(0,react.memo)(_Controller);try{Controller.displayName="Controller",Controller.__docgenInfo={description:"Controller is injected into the iframe DOM for\nmanaging targets (anchors) for annotations",displayName:"Controller",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ExternalDocument/Controller.tsx#Controller"]={docgenInfo:Controller.__docgenInfo,name:"Controller",path:"src/components/ExternalDocument/Controller.tsx#Controller"})}catch(__react_docgen_typescript_loader_error){}function SectionList({anchors}){return(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)("ol",{children:anchors.map((props=>(0,jsx_runtime.jsx)("li",{children:(0,jsx_runtime.jsx)(index_module.zx,{variant:"subtle",style:{marginLeft:16*props.level},onPress:()=>{return(target=props.el).scrollIntoView(),void target.focus();var target},children:props.title.substring(0,50)})},props.id)))})})}function TableOfContents({document}){const[anchors,setAnchors]=(0,react.useState)([]);(0,react.useEffect)((()=>{if(!document)return;const anchorProps=[];document.querySelectorAll("[data-comment-section]").forEach((el=>{anchorProps.push({el,id:el.id,title:el.dataset.commentSection??el.id,level:parseInt(el.dataset.commentSectionLevel??"0")}),el.tabIndex=-1})),console.log("sections",anchorProps),setAnchors(anchorProps)}),[document]);const[open,setOpen]=(0,react.useState)(!1);return(0,jsx_runtime.jsxs)(index_module.Kq,{children:[(0,jsx_runtime.jsx)(index_module.hU,{size:24,label:"Toggle table of contents",variant:"fade",name:"tableOfContents",onPress:()=>setOpen(!open)}),open&&(0,jsx_runtime.jsx)(SectionList,{anchors})]})}SectionList.displayName="SectionList",TableOfContents.displayName="TableOfContents";try{TableOfContents.displayName="TableOfContents",TableOfContents.__docgenInfo={description:"",displayName:"TableOfContents",props:{document:{defaultValue:null,description:"The DOM Document to extract a table of contents from.\n\nThis may either be an iframed document or a\nlive React document.",name:"document",required:!1,type:{name:"Document"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/TableOfContents/TableOfContents.tsx#TableOfContents"]={docgenInfo:TableOfContents.__docgenInfo,name:"TableOfContents",path:"src/components/TableOfContents/TableOfContents.tsx#TableOfContents"})}catch(__react_docgen_typescript_loader_error){}var interactions_dist_import=__webpack_require__("./node_modules/@react-aria/interactions/dist/import.mjs");const Panel=styled_components_browser_esm.ZP.div`
  position: absolute;
  right: 0;
  transition: 200ms;
  background: var(--rui-light);
  border: 2px solid var(--rui-light-shade);
  flex-direction: column;
  margin-right: 4px;
`;function ActionsSidebar(){const{selected,select}=useAnnotationPicker(),{createThread}=useAnnotationsContext(),[isFocusWithin,onFocusWithinChange]=(0,react.useState)(!1),{focusWithinProps}=(0,interactions_dist_import.L_)({onFocusWithinChange}),[top,setTop]=(0,react.useState)(0),[prev,setPrev]=(0,react.useState)(),[active,setActive]=(0,react.useState)(),startThread=motivation=>{if(!active)return;createThread("commenting",{type:"FragmentSelector",value:active.targetField,refinedBy:active.start&&active.end?{type:"TextPositionSelector",start:active.start,end:active.end}:void 0})};return(0,react.useEffect)((()=>{selected&&setTop(selected.top),selected&&setPrev(selected)}),[selected]),(0,react.useEffect)((()=>{setActive(isFocusWithin?prev:selected)}),[isFocusWithin,prev,selected]),(0,jsx_runtime.jsxs)(Panel,{style:{top,display:active?"flex":"none"},...focusWithinProps,children:[(0,jsx_runtime.jsx)(index_module.u,{contentSlot:"Ask a question",children:(0,jsx_runtime.jsx)(index_module.hU,{name:"questioningComment",label:"Ask a question",size:24,onPress:()=>startThread()})}),(0,jsx_runtime.jsx)(index_module.u,{contentSlot:"Add a comment",children:(0,jsx_runtime.jsx)(index_module.hU,{name:"addComment",label:"Add a comment",size:24,onPress:()=>startThread()})}),(0,jsx_runtime.jsx)(index_module.u,{contentSlot:"Make a suggestion",children:(0,jsx_runtime.jsx)(index_module.hU,{name:"suggestionComment",label:"Make a suggestion",size:24})})]})}function useThread(id){const{annotations,createReply,updateBody,focused,patch,focus}=useAnnotationsContext(),[thread,setThread]=(0,react.useState)(),[replies,setReplies]=(0,react.useState)([]);return(0,react.useEffect)((()=>{const match=annotations.find((t=>t.id===id));match&&match!==thread&&setThread(match);const replies=annotations.filter((a=>a.target.id===id));setReplies(replies),console.log("useThread effect ",id)}),[annotations]),(0,react.useMemo)((()=>({thread,focused:focused?.id===id,replies,focus:()=>{thread&&focus(thread.id)},updateComment:message=>{thread&&updateBody("TextualBody",thread.id,(prev=>({...prev,value:message})))},remove:(recoverable=!0)=>{thread&&updateBody("Thread",thread.id,(prev=>({...prev,deleted:!0,recoverable}))),thread&&focused?.id===thread.id&&focus(void 0)},recover:()=>{thread&&updateBody("Thread",thread.id,(prev=>({...prev,deleted:!1})))},resolve:()=>{thread&&updateBody("Thread",thread.id,(prev=>({...prev,resolved:!0})))},reopen:()=>{thread&&updateBody("Thread",thread.id,(prev=>({...prev,resolved:!1})))},addReply:message=>{if(!thread)throw new Error("Invalid thread");const reply=createReply(thread.id,message);return updateBody("Thread",thread.id,(prev=>({...prev}))),reply},updateReply:(id,message)=>{if(replies.findIndex((r=>r.id===id))<0)throw new Error(`Could not update reply: annotation ${id} is not a reply to ${thread?.id}`);updateBody("TextualBody",id,(prev=>({...prev,value:message})))},removeReply:(id,recoverable=!0)=>{if(replies.findIndex((r=>r.id===id))<0)throw new Error(`Could not remove reply: annotation ${id} is not a reply to ${thread?.id}`);updateBody("ThreadReply",id,(prev=>({...prev,deleted:!0,recoverable})))},recoverReply:id=>{if(replies.findIndex((r=>r.id===id))<0)throw new Error(`Could not recover reply: annotation ${id} is not a reply to ${thread?.id}`);updateBody("ThreadReply",id,(prev=>({...prev,deleted:!1})))}})),[thread,replies,patch,focus])}ActionsSidebar.displayName="ActionsSidebar";var extension_placeholder_dist=__webpack_require__("./node_modules/@tiptap/extension-placeholder/dist/index.js");const EditorsContext=(0,react.createContext)({});const EditorStyles=styled_components_browser_esm.ZP.div`

  .ProseMirror {
    border: 1px solid var(--rui-light);
    padding: var(--rui-spacing-xs);
  }
  .ProseMirror-focused {
    outline: none;
    border: 1px solid var(--rui-light);
  }
`;function EditableMessage({defaultValue,placeholder,autosave=!1,onSave,onCancel}){const{setActiveEditor}=(0,react.useContext)(EditorsContext),{focusWithinProps}=(0,interactions_dist_import.L_)({onBlurWithin:e=>{}}),editor=(0,dist.jE)({content:defaultValue,extensions:[starter_kit_dist.Z,extension_placeholder_dist.Z.configure({placeholder})]},[]),handleSave=()=>{if(!editor)return;const textContent=editor.getText(),content=editor.getHTML();editor.chain().clearContent().blur().run(),setActiveEditor(!1),textContent.length>0?onSave(content):onCancel()};return(0,react.useEffect)((()=>(editor&&editor.commands.focus("end"),setActiveEditor(!0),()=>setActiveEditor(!1))),[editor]),(0,jsx_runtime.jsxs)(index_module.Kq,{align:"stretch",fs:"sm",children:[(0,jsx_runtime.jsx)(EditorStyles,{children:(0,jsx_runtime.jsx)(dist.kg,{editor,onKeyDown:(0,parse_hotkey.yr)([["mod+Enter",handleSave]])})}),(0,jsx_runtime.jsxs)(index_module.ZA,{justify:"end",align:"center",children:[(0,jsx_runtime.jsx)(index_module.xv,{fs:"xs",c:"dark",children:"Tip: Press Ctrl+Enter to save."}),(0,jsx_runtime.jsx)(index_module.zx,{variant:"subtle",onPress:()=>{editor&&(editor.chain().clearContent().blur().run(),setActiveEditor(!1),onCancel())},children:"Cancel"}),(0,jsx_runtime.jsx)(index_module.zx,{onPress:handleSave,children:"Save"})]})]})}EditableMessage.displayName="EditableMessage";try{EditableMessage.displayName="EditableMessage",EditableMessage.__docgenInfo={description:"Rich text editor with a save/cancel button visible on mount.\n\na11y\n- Focuses on the text input on mount\n- Traps keyboard focus until closed",displayName:"EditableMessage",props:{defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!0,type:{name:"string"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},autosave:{defaultValue:{value:"false"},description:"",name:"autosave",required:!1,type:{name:"boolean"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!0,type:{name:"(value: string) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Thread/EditableMessage.tsx#EditableMessage"]={docgenInfo:EditableMessage.__docgenInfo,name:"EditableMessage",path:"src/components/Thread/EditableMessage.tsx#EditableMessage"})}catch(__react_docgen_typescript_loader_error){}var dayjs_min=__webpack_require__("./node_modules/dayjs/dayjs.min.js"),dayjs_min_default=__webpack_require__.n(dayjs_min);function Profile({node,showRole}){const body=node.body.find((b=>"ThreadReply"===b.type||"Thread"===b.type)),role=body?body.role:"";return(0,jsx_runtime.jsxs)(index_module.ZA,{align:"center",gap:"xs",fs:"sm",w:"100%",children:[(0,jsx_runtime.jsx)(index_module.qE,{alt:node.creator.name,size:40,name:node.creator.name,opicUsername:node.creator.nickname,style:{marginLeft:-36}}),(0,jsx_runtime.jsxs)(index_module.Kq,{gap:0,w:"100%",children:[(0,jsx_runtime.jsx)(index_module.ZA,{w:"100%",justify:"apart",children:(0,jsx_runtime.jsx)(index_module.xv,{fw:"bold",children:node.creator.name})}),(0,jsx_runtime.jsx)(index_module.xv,{fs:"xs",c:"dark",children:dayjs_min_default()(node.created).format("h:mm A MMM D")})]}),showRole&&role&&(0,jsx_runtime.jsx)(index_module.Af,{variant:"outline",c:"secondary",children:role})]})}Profile.displayName="Profile";try{Profile.displayName="Profile",Profile.__docgenInfo={description:"",displayName:"Profile",props:{node:{defaultValue:null,description:"",name:"node",required:!0,type:{name:"Annotation"}},showRole:{defaultValue:null,description:"",name:"showRole",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Thread/Profile.tsx#Profile"]={docgenInfo:Profile.__docgenInfo,name:"Profile",path:"src/components/Thread/Profile.tsx#Profile"})}catch(__react_docgen_typescript_loader_error){}function ReadOnlyMessage({message}){return(0,jsx_runtime.jsx)(index_module.xv,{fs:"sm",children:(0,jsx_runtime.jsx)("span",{dangerouslySetInnerHTML:{__html:message}})})}ReadOnlyMessage.displayName="ReadOnlyMessage";try{ReadOnlyMessage.displayName="ReadOnlyMessage",ReadOnlyMessage.__docgenInfo={description:"",displayName:"ReadOnlyMessage",props:{message:{defaultValue:null,description:"",name:"message",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Thread/ReadOnlyMessage.tsx#ReadOnlyMessage"]={docgenInfo:ReadOnlyMessage.__docgenInfo,name:"ReadOnlyMessage",path:"src/components/Thread/ReadOnlyMessage.tsx#ReadOnlyMessage"})}catch(__react_docgen_typescript_loader_error){}const Reply=react.forwardRef((({thread,node},ref)=>{const{focused,replies,updateReply,removeReply,recoverReply}=useThread(thread.id),{hasActiveEditor}=(0,react.useContext)(EditorsContext),[isEditing,setEditing]=(0,react.useState)(!1),body=node.body.find((b=>"TextualBody"===b.type)),state=node.body.find((b=>"ThreadReply"===b.type)),threadState=thread.body.find((b=>"Thread"===b.type)),defaultValue=body.value,{deleted,recoverable}=state,{resolved}=threadState;return deleted&&!recoverable?null:deleted&&recoverable?(0,jsx_runtime.jsxs)(index_module.xv,{p:"md",fs:"sm",children:["Deleted reply."," ",(0,jsx_runtime.jsx)(index_module.rU,{as:"button",onClick:()=>recoverReply(node.id),children:"(undo)"})]}):(0,jsx_runtime.jsxs)(index_module.Kq,{align:"stretch",gap:0,pl:"xl",tabIndex:0,children:[(0,jsx_runtime.jsxs)(index_module.ZA,{justify:"apart",align:"center",pb:"md",children:[(0,jsx_runtime.jsx)(Profile,{node,showRole:!0}),!resolved&&(0,jsx_runtime.jsxs)(index_module.v2,{label:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}),onAction:key=>("delete"===key?removeReply(node.id):"edit"===key&&setEditing(!0),!0),disabledKeys:hasActiveEditor?["edit","delete"]:[],children:[(0,jsx_runtime.jsx)(index_module.ck,{children:"Edit reply"},"edit"),(0,jsx_runtime.jsx)(index_module.ck,{children:(0,jsx_runtime.jsx)(index_module.xv,{c:"error",children:"Delete"})},"delete")]})]}),(0,jsx_runtime.jsx)(index_module.ZA,{pl:"md",children:isEditing?(0,jsx_runtime.jsx)(EditableMessage,{defaultValue,onSave:message=>{updateReply(node.id,message),setEditing(!1)},onCancel:()=>setEditing(!1)}):(0,jsx_runtime.jsx)(ReadOnlyMessage,{message:defaultValue})})]})}));try{Reply.displayName="Reply",Reply.__docgenInfo={description:"Render a comment as a reply to a thread",displayName:"Reply",props:{thread:{defaultValue:null,description:"",name:"thread",required:!0,type:{name:"Annotation"}},node:{defaultValue:null,description:"",name:"node",required:!0,type:{name:"Annotation"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Thread/Reply.tsx#Reply"]={docgenInfo:Reply.__docgenInfo,name:"Reply",path:"src/components/Thread/Reply.tsx#Reply"})}catch(__react_docgen_typescript_loader_error){}const Root=styled_components_browser_esm.ZP.div`
  border: 1px solid var(--rui-light);
  padding: var(--rui-spacing-xs);
`;function StartReply({thread}){const{hasActiveEditor}=(0,react.useContext)(EditorsContext),[active,setActive]=(0,react.useState)(!1),{addReply}=useThread(thread.id);return(0,jsx_runtime.jsxs)(index_module.Kq,{align:"stretch",fs:"sm",children:[!active&&(0,jsx_runtime.jsx)(index_module.kG,{isDisabled:hasActiveEditor,as:Root,onPress:()=>{setActive(!0)},c:"dark",children:(0,jsx_runtime.jsx)(index_module.ZA,{children:hasActiveEditor?"Another comment is in progress.":"Reply"})}),active&&(0,jsx_runtime.jsx)(EditableMessage,{placeholder:"Reply",onSave:message=>{addReply(message),setActive(!1)},onCancel:()=>{setActive(!1)},defaultValue:""})]})}StartReply.displayName="StartReply";try{StartReply.displayName="StartReply",StartReply.__docgenInfo={description:"",displayName:"StartReply",props:{thread:{defaultValue:null,description:"",name:"thread",required:!0,type:{name:"Annotation"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Thread/StartReply.tsx#StartReply"]={docgenInfo:StartReply.__docgenInfo,name:"StartReply",path:"src/components/Thread/StartReply.tsx#StartReply"})}catch(__react_docgen_typescript_loader_error){}const CellListContext=(0,react.createContext)({});function useCellList(){const{items,getItem,append,remove,update,selectedKeys,setSelectedKeys}=(0,dist_import.SH)({getKey:item=>item.id}),selectedKey=selectedKeys.values().next().value,focused=selectedKey?getItem(selectedKey):void 0;return(0,react.useLayoutEffect)((()=>{items.length>0&&(id=>{if(items.length<1)return;const sorted=[...items].sort(((a,b)=>a.anchorCell-b.anchorCell)),anchoredIndex=sorted.findIndex((c=>c.id===id));if(anchoredIndex<0)return;const updated=[];let max=sorted[anchoredIndex].anchorCell;for(let i=anchoredIndex-1;i>=0;i--){const current=sorted[i];max=Math.min(current.anchorCell+current.height,max),current.cell!==max-current.height&&(current.cell=max-current.height,updated.push(i)),max=current.cell}sorted[anchoredIndex].cell!==sorted[anchoredIndex].anchorCell&&(sorted[anchoredIndex].cell=sorted[anchoredIndex].anchorCell,updated.push(anchoredIndex));let min=sorted[anchoredIndex].anchorCell+sorted[anchoredIndex].height;for(let i=anchoredIndex+1;i<sorted.length;i++){const current=sorted[i];min=Math.max(current.anchorCell,min),current.cell!==min&&(current.cell=min,updated.push(i)),min=current.cell+current.height}updated.forEach((i=>update(sorted[i].id,sorted[i])))})(focused?focused.id:items[0].id)}),[items,focused]),{items,focused,getItem,focus:id=>{getItem(id)&&setSelectedKeys(new Set([id]))},resetFocus:()=>{setSelectedKeys(new Set([]))},addItem:item=>{if(getItem(item.id))throw new Error("CellListItem already exists with ID: "+item.id);append(item)},removeItem:id=>{remove(id)},updateItem:(id,item)=>{update(id,item)}}}function useElementSize(){const[ref,{width,height}]=function useResizeObserver(){const frameID=(0,react.useRef)(0),ref=(0,react.useRef)(null),[rect,setRect]=(0,react.useState)({x:0,y:0,width:0,height:0}),observer=(0,react.useMemo)((()=>"undefined"!=typeof window?new ResizeObserver((entries=>{const entry=entries[0];entry&&(cancelAnimationFrame(frameID.current),frameID.current=requestAnimationFrame((()=>{ref.current&&setRect(entry.contentRect)})))})):null),[]);return(0,react.useEffect)((()=>(ref.current&&observer?.observe(ref.current),()=>{observer?.disconnect(),frameID.current&&cancelAnimationFrame(frameID.current)})),[ref.current]),[ref,rect]}();return{ref,width,height}}const AnimatedContainer=styled_components_browser_esm.ZP.div`
  transition: 200ms;
`;function AnchoredContainer({id,anchor,focused,gap,children}){const anchorPos=anchor?.target||{y:0,x:0,width:0,height:0},{ref,height}=useElementSize(),heightWithGap=height+gap,{item,update,focus}=function useCellListItem(id,anchorCell){const{getItem,addItem,removeItem,updateItem,focus}=(0,react.useContext)(CellListContext),item=getItem(id);return item||addItem({id,cell:0,anchorCell,height:0}),item&&anchorCell!==item.anchorCell&&updateItem(id,{...item,anchorCell}),(0,react.useEffect)((()=>()=>removeItem(id)),[id]),{item,update:state=>{updateItem(id,state)},focus:()=>focus(id)}}(id,anchorPos.y);return(0,react.useEffect)((()=>{if(!item)return;const updated={...item};heightWithGap!==item.height&&(updated.height=heightWithGap,update(updated)),focused&&focus()}),[item,id,anchorPos,heightWithGap,focused]),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(index_module.hU,{size:20,label:"Icon here",name:"comment",style:{position:"absolute",transform:`translateY(${item?.anchorCell??0}px) translateX(-48px)`}}),(0,jsx_runtime.jsx)(AnimatedContainer,{ref,style:{position:"absolute",transform:item?.cell?`translateY(${item?.cell??0}px) translateX(${focused?-12:0}px)`:void 0},children})]})}try{AnchoredContainer.displayName="AnchoredContainer",AnchoredContainer.__docgenInfo={description:"Responsible for keeping body content aligned with a target anchor.",displayName:"AnchoredContainer",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},anchor:{defaultValue:null,description:"",name:"anchor",required:!1,type:{name:"Anchor"}},focused:{defaultValue:null,description:"",name:"focused",required:!0,type:{name:"boolean"}},gap:{defaultValue:null,description:"Additional spacing between adjacent containers",name:"gap",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/AnchoredContainer/AnchoredContainer.tsx#AnchoredContainer"]={docgenInfo:AnchoredContainer.__docgenInfo,name:"AnchoredContainer",path:"src/components/AnchoredContainer/AnchoredContainer.tsx#AnchoredContainer"})}catch(__react_docgen_typescript_loader_error){}function Thread({node}){const ref=(0,react.useRef)(null),{getAnchor}=useAnchorsContext(),{hasActiveEditor}=(0,react.useContext)(EditorsContext),body=node.body.find((b=>"TextualBody"===b.type)),state=node.body.find((b=>"Thread"===b.type));if("FragmentSelector"!==node.target.selector?.type)throw new Error("Unexpected target selector associated with thread annotation. Expected FragmentSelector");const fragment=node.target.selector,anchor=getAnchor({id:"TextPositionSelector"===fragment.refinedBy?.type?node.id:void 0,source:fragment.value}),{focused,replies,focus,updateComment,resolve,reopen,remove,recover}=useThread(node.id),[isEditing,setEditing]=(0,react.useState)(!1),[isAutofocus,setAutofocus]=(0,react.useState)(!1),defaultValue=body.value,{deleted,recoverable,resolved}=state,isInitial=defaultValue.trim().length<1;(0,react.useEffect)((()=>{ref.current&&focused&&isInitial&&(setEditing(!0),setAutofocus(!0))}),[node,ref,focused,isInitial]);return(0,react.useEffect)((()=>{if(!ref.current)return;const onEnter=()=>{focus()};return ref.current.addEventListener("click",onEnter),()=>{ref.current?.removeEventListener("click",onEnter)}}),[ref,focus]),deleted&&recoverable?(0,jsx_runtime.jsxs)(index_module.Xk,{withBorder:!0,p:"xs",children:["Deleted thread."," ",(0,jsx_runtime.jsx)(index_module.rU,{as:"button",onClick:recover,children:"(undo)"})]}):deleted?null:(0,jsx_runtime.jsx)(AnchoredContainer,{id:node.id,anchor,focused,gap:16,children:(0,jsx_runtime.jsx)(index_module.Xk,{id:"thread-"+node.id,p:"xs",ml:"xl",ref,tabIndex:0,className:(0,index_module.cx)({"rui-border-2":!0,"rui-border-light":!focused,"rui-border-blue":focused}),w:352,children:(0,jsx_runtime.jsxs)(index_module.Kq,{align:"stretch",gap:"md",px:"xs",pb:"xs",children:[resolved&&(0,jsx_runtime.jsxs)(index_module.ZA,{justify:"apart",align:"center",children:[(0,jsx_runtime.jsx)(Profile,{node}),(0,jsx_runtime.jsxs)(index_module.ZA,{align:"center",children:[(0,jsx_runtime.jsxs)(index_module.Af,{variant:"outline",c:"green",children:[(0,jsx_runtime.jsx)(index_module.JO,{name:"check"})," resolved"]}),(0,jsx_runtime.jsx)(index_module.hU,{size:16,iconProps:{p:"xxs"},name:"rotate",label:"Reopen",onPress:reopen})]})]}),!resolved&&(0,jsx_runtime.jsxs)(index_module.ZA,{justify:"apart",align:"center",children:[(0,jsx_runtime.jsx)(Profile,{node,showRole:!0}),(0,jsx_runtime.jsxs)(index_module.v2,{label:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}),onAction:key=>("resolve"===key?resolve():"delete"===key?remove():"edit"===key&&setEditing(!0),!0),disabledKeys:hasActiveEditor?["edit","resolve","delete"]:[],children:[(0,jsx_runtime.jsx)(index_module.ck,{children:"Edit comment"},"edit"),(0,jsx_runtime.jsx)(index_module.ck,{children:"Resolve thread"},"resolve"),(0,jsx_runtime.jsx)(index_module.ck,{children:(0,jsx_runtime.jsx)(index_module.xv,{c:"error",children:"Delete thread"})},"delete")]})]}),(0,jsx_runtime.jsxs)(index_module.xu,{pl:"sm",children:[isEditing?(0,jsx_runtime.jsx)(EditableMessage,{defaultValue,autosave:isAutofocus,onSave:message=>{"<p></p>"===message.trim()&&(message=""),updateComment(message),setEditing(!1),!message.length&&message.length<1&&remove(!1)},onCancel:()=>{setEditing(!1),defaultValue.length<1&&replies.length<1&&remove(!1)}}):(0,jsx_runtime.jsx)(ReadOnlyMessage,{message:defaultValue}),resolved&&replies.length>0&&!focused&&(0,jsx_runtime.jsx)(index_module.xv,{fs:"xs",fw:"bold",children:1===replies.length?"1 more reply":replies.length+" more replies"})]}),(!resolved||focused)&&replies.map((reply=>(0,jsx_runtime.jsx)(Reply,{thread:node,node:reply},reply.id))),!resolved&&!isInitial&&focused&&(0,jsx_runtime.jsx)(StartReply,{thread:node})]})})})}Thread.displayName="Thread";try{Thread.displayName="Thread",Thread.__docgenInfo={description:"",displayName:"Thread",props:{node:{defaultValue:null,description:"",name:"node",required:!0,type:{name:"Annotation"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Thread/Thread.tsx#Thread"]={docgenInfo:Thread.__docgenInfo,name:"Thread",path:"src/components/Thread/Thread.tsx#Thread"})}catch(__react_docgen_typescript_loader_error){}const ThreadList=(0,react.forwardRef)(((props,ref)=>{const{annotations}=useAnnotationsContext(),cellList=useCellList(),filtered=[...annotations.filter((a=>"replying"!==a.motivation))];return filtered.sort(((a,b)=>{const aItem=cellList.getItem(a.id),bItem=cellList.getItem(b.id);return aItem&&bItem?aItem.anchorCell-bItem.anchorCell:0})),(0,jsx_runtime.jsxs)("div",{ref,children:[(0,jsx_runtime.jsxs)(index_module.zx,{variant:"subtle",onPress:()=>console.log(annotations),style:{position:"absolute",top:0,right:0},children:[(0,jsx_runtime.jsx)(index_module.JO,{name:"code"})," Print annotations to console"]}),(0,jsx_runtime.jsxs)(CellListContext.Provider,{value:cellList,children:[(0,jsx_runtime.jsx)(AnchorButtons,{}),filtered?.map((anno=>(0,jsx_runtime.jsx)(Thread,{node:anno},anno.id)))]})]})}));function AnchorButtons(){return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}try{ThreadList.displayName="ThreadList",ThreadList.__docgenInfo={description:"",displayName:"ThreadList",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ThreadList/ThreadList.tsx#ThreadList"]={docgenInfo:ThreadList.__docgenInfo,name:"ThreadList",path:"src/components/ThreadList/ThreadList.tsx#ThreadList"})}catch(__react_docgen_typescript_loader_error){}function ExternalDocument(props){const frameRef=(0,react.useRef)(null),listRef=(0,react.useRef)(null);(0,react.useLayoutEffect)((()=>{if(!frameRef.current)return;let handle,prev=0;const watch=()=>{const container=frameRef.current?.contentWindow?.document.body;cancelAnimationFrame(handle),container&&prev!==container.scrollHeight&&(prev=container.scrollHeight,frameRef.current.height=prev+64+"px"),handle=requestAnimationFrame(watch)};return handle=requestAnimationFrame(watch),()=>cancelAnimationFrame(handle)}),[frameRef,listRef]);const ctx=function useAnchors(){const{items,append,update,remove}=(0,dist_import.SH)({getKey:item=>item.id});return(0,react.useMemo)((()=>{const getAnchor=ref=>items.find((a=>ref.id===a.id||!ref.id&&a.source===ref.source));return console.log("updated anchors",items),{items,getAnchor,addAnchors:anchors=>{anchors.forEach((a=>{const existing=getAnchor(a);if(existing){if(existing.id===a.id&&existing.source===a.source&&existing.type===a.type&&existing.target.y===a.target.y)return;update(existing.id,{...existing,...a})}else append({...a,id:a.id??(0,v4.Z)()})}))}}}),[items,append,update,remove])}(),document=frameRef.current?.contentWindow?.document;return(0,jsx_runtime.jsx)(Context.Provider,{value:ctx,children:(0,jsx_runtime.jsxs)(index_module.ZA,{bgc:"light",justify:"center",miw:"calc(21cm + 400px)",py:"md",align:"stretch",gap:0,children:[document&&(0,jsx_runtime.jsx)(TableOfContents,{document}),(0,jsx_runtime.jsxs)(index_module.Xk,{w:"21cm",miw:"21cm",p:"xxl",withBorder:!0,shadow:"md",children:[(0,jsx_runtime.jsx)(lib.ZP,{ref:frameRef,initialContent:props.content,head:(0,jsx_runtime.jsx)("style",{children:"\n  comment-view[data-comment] {\n    background-color: yellow;\n  }\n\n  comment-focus-view[data-comment] {\n    background-color: gold;\n    text-decoration: underline;\n  }\n\n  [data-comment-block]:hover {\n    cursor: pointer;\n    background-color: lightyellow;\n  }\n"}),onLoad:e=>e.stopPropagation(),style:{width:"100%",margin:0},children:(0,jsx_runtime.jsx)(Controller,{})}),(0,jsx_runtime.jsx)(ActionsSidebar,{})]}),(0,jsx_runtime.jsx)(index_module.Kq,{align:"stretch",w:400,miw:400,pt:"xxl",className:"threads",children:(0,jsx_runtime.jsx)(ThreadList,{ref:listRef})})]})})}ExternalDocument.displayName="ExternalDocument";try{ExternalDocument.displayName="ExternalDocument",ExternalDocument.__docgenInfo={description:"Container for a reviewable document that was generated through\nan external HTML renderer.\n\nDocument content is rendered within a controlled iframe\nand tagged elements are converted into controlled React\ncomponents through a portal.\n\n## ðŸ“– Storybook Dev Mode\n\nNote that running this in Storybook dev mode may occasionally break\ndue to hot reloading. The component is built to be mounted once.",displayName:"ExternalDocument",props:{content:{defaultValue:null,description:"DOM content to render as a reviewable document.\n\nThis cannot be changed once the component has mounted.",name:"content",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ExternalDocument/ExternalDocument.tsx#ExternalDocument"]={docgenInfo:ExternalDocument.__docgenInfo,name:"ExternalDocument",path:"src/components/ExternalDocument/ExternalDocument.tsx#ExternalDocument"})}catch(__react_docgen_typescript_loader_error){}var dist_index_module=__webpack_require__("./node_modules/@osuresearch/iconography/dist/index.module.js"),book_open_outline=__webpack_require__("./node_modules/@iconify/icons-mdi/book-open-outline.js"),comment_outline=__webpack_require__("./node_modules/@iconify/icons-mdi/comment-outline.js"),comment_multiple_outline=__webpack_require__("./node_modules/@iconify/icons-mdi/comment-multiple-outline.js"),comment_plus_outline=__webpack_require__("./node_modules/@iconify/icons-mdi/comment-plus-outline.js"),comment_question_outline=__webpack_require__("./node_modules/@iconify/icons-mdi/comment-question-outline.js"),comment_edit_outline=__webpack_require__("./node_modules/@iconify/icons-mdi/comment-edit-outline.js"),comment_check_outline=__webpack_require__("./node_modules/@iconify/icons-mdi/comment-check-outline.js"),comment_alert_outline=__webpack_require__("./node_modules/@iconify/icons-mdi/comment-alert-outline.js");const icons={tableOfContents:book_open_outline.Z,comment:comment_outline.Z,multipleComments:comment_multiple_outline.Z,addComment:comment_plus_outline.Z,questioningComment:comment_question_outline.Z,suggestionComment:comment_edit_outline.Z,resolvedComment:comment_check_outline.Z,alertComment:comment_alert_outline.Z};function AnnotationsProvider({documentId,children,initialItems,agent,role}){const ctx=function useAnnotations(documentId,initialItems=[],agent,role){const{items,selectedKeys,getItem,append,update,setSelectedKeys}=(0,dist_import.SH)({initialItems,getKey:anno=>anno.id}),[isEditingComment,setIsEditingComment]=(0,react.useState)(!1);return(0,react.useMemo)((()=>{const focusedAnnotationID=selectedKeys.values().next().value;return{annotations:items,focused:focusedAnnotationID?getItem(focusedAnnotationID):void 0,isEditingComment,setIsEditingComment,focus(id){setSelectedKeys(new Set(id?[id]:[]))},createThread(motivation,selector,annotationId){const now=(new Date).toISOString(),anno={"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:annotationId??(0,v4.Z)(),motivation,created:now,modified:now,creator:agent,target:{id:documentId,selector},body:[{type:"TextualBody",value:"",format:"text/html",language:"en"},{type:"Thread",role,requiresResponse:!1,resolved:!1,deleted:!1,recoverable:!0}]};return append(anno),setSelectedKeys(new Set([anno.id])),anno},createReply(threadAnnotationId,message,replyAnnotationId){const now=(new Date).toISOString(),anno={"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:replyAnnotationId??(0,v4.Z)(),motivation:"replying",created:now,modified:now,creator:agent,target:{id:threadAnnotationId},body:[{type:"TextualBody",value:message,format:"text/html",language:"en"},{type:"ThreadReply",role,deleted:!1,recoverable:!0}]};return append(anno),anno},patch(id,action){const anno=getItem(id);update(id,action(anno))},updateBody:(type,id,action)=>{const anno=getItem(id);update(id,{...anno,body:anno.body.map((b=>b.type===type?action(b):b))})}}}),[items,documentId,isEditingComment,selectedKeys,agent,role])}(documentId,initialItems,agent,role),editors=function useEditors(){const[hasActiveEditor,setActiveEditor]=(0,react.useState)(!1);return{hasActiveEditor,setActiveEditor}}(),[selected,select]=(0,react.useState)(),selectionCtx=(0,react.useMemo)((()=>({select,selected,deselect:()=>select(void 0)})),[selected]);return(0,react.useEffect)((()=>{!function loadAllIcons(){Object.keys(icons).forEach((name=>{(0,dist_index_module.Ug)(name,icons[name])}))}()}),[]),(0,jsx_runtime.jsx)(AnnotationsContext.Provider,{value:ctx,children:(0,jsx_runtime.jsx)(EditorsContext.Provider,{value:editors,children:(0,jsx_runtime.jsx)(AnnotationPickerContext.Provider,{value:selectionCtx,children})})})}AnnotationsProvider.displayName="AnnotationsProvider";try{AnnotationsProvider.displayName="AnnotationsProvider",AnnotationsProvider.__docgenInfo={description:"Thin wrapper around the useAnnotations hook.",displayName:"AnnotationsProvider",props:{documentId:{defaultValue:null,description:"Unique IRI of the document being annotated",name:"documentId",required:!0,type:{name:"string"}},initialItems:{defaultValue:null,description:"Initial annotation instances to display",name:"initialItems",required:!1,type:{name:"Annotation[]"}},agent:{defaultValue:null,description:"The agent to use for newly created annotations",name:"agent",required:!0,type:{name:"AnnotationAgent"}},role:{defaultValue:null,description:"The role for the agent. This is heavily dependent\non the context in which the annotator is used.\n\nFor forms, this could be `Submitter`, `Reviewer`,\n`Analyst`, etc. Roles may also represent individual's\nrelationship to the submission, such as a `Principal Investigator`\nversus a `Co-Investigator` on a study.",name:"role",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/AnnotationsProvider/AnnotationsProvider.tsx#AnnotationsProvider"]={docgenInfo:AnnotationsProvider.__docgenInfo,name:"AnnotationsProvider",path:"src/components/AnnotationsProvider/AnnotationsProvider.tsx#AnnotationsProvider"})}catch(__react_docgen_typescript_loader_error){}const shortFormAnnotations=[{"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"617cf321-fac1-4a1d-a235-224bf28faff0",motivation:"commenting",created:"2023-03-10T16:45:37.514Z",modified:"2023-03-10T16:45:37.514Z",creator:{type:"Person",id:"0123456",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},target:{id:"mock-document",selector:{type:"FragmentSelector",value:"field13",refinedBy:{type:"TextPositionSelector",start:48,end:74}}},body:[{type:"TextualBody",value:"<p>And an inline for Nullam egestas urna risus of section 4</p>",format:"text/html",language:"en"},{type:"Thread",role:"Test",requiresResponse:!1,resolved:!1,deleted:!1,recoverable:!0}]},{"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"94a71eb5-a90e-4695-b2a8-556428d5416c",motivation:"replying",created:"2023-03-10T16:49:04.065Z",modified:"2023-03-10T16:49:04.065Z",creator:{type:"Person",id:"0123456",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},target:{id:"9d26aaef-5c1c-4c46-88f0-60f69de6ed9e"},body:[{type:"TextualBody",value:"<p>And a reply about that 2.2 </p>",format:"text/html",language:"en"},{type:"ThreadReply",role:"Test",deleted:!1,recoverable:!0}]},{"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"47509192-8945-4522-b251-2aba3a7f22df",motivation:"replying",created:"2023-03-10T16:49:08.321Z",modified:"2023-03-10T16:49:08.321Z",creator:{type:"Person",id:"0123456",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},target:{id:"9d26aaef-5c1c-4c46-88f0-60f69de6ed9e"},body:[{type:"TextualBody",value:"<p>With another reply about it.</p>",format:"text/html",language:"en"},{type:"ThreadReply",role:"Test",deleted:!1,recoverable:!0}]},{"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"ca3c2575-44c1-4af5-8fd4-5cd46ffa5dcd",motivation:"commenting",created:"2023-03-10T16:44:38.927Z",modified:"2023-03-10T16:44:38.927Z",creator:{type:"Person",id:"0123456",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},target:{id:"mock-document",selector:{type:"FragmentSelector",value:"field1",refinedBy:{type:"TextPositionSelector",start:32,end:58}}},body:[{type:"TextualBody",value:"<p>inline comment for Lorem ipsum dolor sit amet</p>",format:"text/html",language:"en"},{type:"Thread",role:"Test",requiresResponse:!1,resolved:!1,deleted:!1,recoverable:!0}]},{"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"b92f78c4-94ef-4c16-8cfa-444a3a40ecb5",motivation:"commenting",created:"2023-03-10T16:44:49.542Z",modified:"2023-03-10T16:44:49.542Z",creator:{type:"Person",id:"0123456",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},target:{id:"mock-document",selector:{type:"FragmentSelector",value:"field1",refinedBy:{type:"TextPositionSelector",start:244,end:271}}},body:[{type:"TextualBody",value:"<p>And an inline for Vestibulum eu aliquet ipsum in section 2</p>",format:"text/html",language:"en"},{type:"Thread",role:"Test",requiresResponse:!1,resolved:!1,deleted:!1,recoverable:!0}]},{"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"9d26aaef-5c1c-4c46-88f0-60f69de6ed9e",motivation:"commenting",created:"2023-03-10T16:45:06.273Z",modified:"2023-03-10T16:45:06.273Z",creator:{type:"Person",id:"0123456",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},target:{id:"mock-document",selector:{type:"FragmentSelector",value:"field6"}},body:[{type:"TextualBody",value:"<p>Block level comment for subsection 2.2</p>",format:"text/html",language:"en"},{type:"Thread",role:"Test",requiresResponse:!1,resolved:!1,deleted:!1,recoverable:!0}]},{"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"06e98c5b-00f7-42a9-8651-fa46832d6439",motivation:"commenting",created:"2023-03-10T16:45:19.907Z",modified:"2023-03-10T16:45:19.907Z",creator:{type:"Person",id:"0123456",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},target:{id:"mock-document",selector:{type:"FragmentSelector",value:"field8"}},body:[{type:"TextualBody",value:"<p>Block comment for Curabitur vel turpis</p>",format:"text/html",language:"en"},{type:"Thread",role:"Test",requiresResponse:!1,resolved:!1,deleted:!1,recoverable:!0}]},{"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"2a068ceb-f83f-4fc8-92bb-7f895616d4e1",motivation:"commenting",created:"2023-03-10T16:45:30.301Z",modified:"2023-03-10T16:45:30.301Z",creator:{type:"Person",id:"0123456",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},target:{id:"mock-document",selector:{type:"FragmentSelector",value:"field12"}},body:[{type:"TextualBody",value:"<p>Block comment for Proin sit amet turpis</p>",format:"text/html",language:"en"},{type:"Thread",role:"Test",requiresResponse:!1,resolved:!1,deleted:!1,recoverable:!0}]},{"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"7aab03d9-4005-4ca2-8830-4cdcccec54fa",motivation:"commenting",created:"2023-03-10T16:48:09.045Z",modified:"2023-03-10T16:48:09.045Z",creator:{type:"Person",id:"0123456",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},target:{id:"mock-document",selector:{type:"FragmentSelector",value:"field5",refinedBy:{type:"TextPositionSelector",start:49,end:166}}},body:[{type:"TextualBody",value:"<p>Subsection 2.1 Nullam egestas urna risus, nec sodales nisl facilisis sed. Duis vitae velit sed ipsum consectetur blandit ut at diam.</p>",format:"text/html",language:"en"},{type:"Thread",role:"Test",requiresResponse:!1,resolved:!1,deleted:!1,recoverable:!0}]},{"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"31b7810d-f21f-4a23-a13a-cce093f25df8",motivation:"replying",created:"2023-03-10T16:48:25.842Z",modified:"2023-03-10T16:48:25.842Z",creator:{type:"Person",id:"0123456",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},target:{id:"7aab03d9-4005-4ca2-8830-4cdcccec54fa"},body:[{type:"TextualBody",value:"<p>And some reply about that</p>",format:"text/html",language:"en"},{type:"ThreadReply",role:"Test",deleted:!1,recoverable:!0}]},{"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"d467008c-0370-4000-a80e-f6e4eedd6ed9",motivation:"replying",created:"2023-03-10T16:48:36.929Z",modified:"2023-03-10T16:48:36.929Z",creator:{type:"Person",id:"0123456",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},target:{id:"ca3c2575-44c1-4af5-8fd4-5cd46ffa5dcd"},body:[{type:"TextualBody",value:"<p>And a reply about lorem ipsum</p>",format:"text/html",language:"en"},{type:"ThreadReply",role:"Test",deleted:!1,recoverable:!0}]}],annotations=[{"@context":["https://www.w3.org/ns/anno.jsonld"],id:"a1560fa8-965d-4b8a-84af-dcc2eabf4b26",type:"Annotation",motivation:"commenting",body:[{type:"TextualBody",value:"<p>Praesent consectetur <strong>scelerisque blandit</strong>.</p>",format:"text/html",language:"en"},{type:"Thread",role:"Reviewer",requiresResponse:!1,resolved:!1,deleted:!1,recoverable:!0}],target:{id:"mock-document",selector:{type:"FragmentSelector",value:"section-0",refinedBy:{type:"TextPositionSelector",start:451,end:462}}},creator:{type:"Person",id:"test",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},created:"2023-02-24T15:40:45Z",modified:"2023-02-24T15:40:45Z"},{"@context":["https://www.w3.org/ns/anno.jsonld"],id:"7334d7fb-3c7b-4454-8e02-7e5ce4f7e2a1",type:"Annotation",motivation:"commenting",body:[{type:"TextualBody",value:"Suspendisse potenti. Nulla in lectus quis sapien dignissim finibus ac vel sapien. Quisque eu lacus massa. Nam odio lorem, porttitor sed fringilla luctus, facilisis quis tortor. Integer eget pretium libero, eu gravida magna.",format:"text/html",language:"en"},{type:"Thread",role:"Reviewer",requiresResponse:!1,resolved:!1,deleted:!1,recoverable:!0}],target:{id:"mock-document",selector:{type:"FragmentSelector",value:"section-0",refinedBy:{type:"TextPositionSelector",start:397,end:411}}},creator:{type:"Person",id:"test",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},created:"2023-02-24T15:40:45Z",modified:"2023-02-24T15:40:45Z"},{"@context":["https://www.w3.org/ns/anno.jsonld"],id:"1f86b7be-fb2d-8405-72h2-6afaca8c8a6",type:"Annotation",motivation:"commenting",body:[{type:"TextualBody",value:"Mauris finibus, urna sit amet euismod pellentesque, dolor diam hendrerit diam, eu rhoncus justo nisi non turpis. ",format:"text/html",language:"en"},{type:"Thread",role:"Reviewer",requiresResponse:!1,resolved:!1,deleted:!1,recoverable:!0}],target:{id:"mock-document",selector:{type:"FragmentSelector",value:"section-0",refinedBy:{type:"TextPositionSelector",start:556,end:614}}},creator:{type:"Person",id:"test",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},created:"2023-02-24T15:40:45Z",modified:"2023-02-24T15:40:45Z"},{"@context":["https://www.w3.org/ns/anno.jsonld"],id:"944fd074-4c0b-42f1-bc22-a6dc5983bf2a",type:"Annotation",motivation:"commenting",body:[{type:"TextualBody",value:"<p>This comment is near the end of the document</p>.",format:"text/html",language:"en"},{type:"Thread",role:"Analyst",requiresResponse:!1,resolved:!1,deleted:!1,recoverable:!0}],target:{id:"mock-document",selector:{type:"FragmentSelector",value:"section-95",refinedBy:{type:"TextPositionSelector",start:235,end:366}}},creator:{type:"Person",id:"test",name:"Neil",email:"coplin.7@osu.edu",nickname:"coplin.7"},created:"2023-02-24T15:40:45Z",modified:"2023-02-24T15:40:45Z"}],ExternalDocument_stories={title:"Components/ExternalDocument",component:ExternalDocument,argTypes:{}},demoContent='\n<!DOCTYPE html>\n<html>\n  <head>\n    <style>\n      * {\n        color: purple;\n      }\n      h1 {\n        color: green;\n      }\n\n      .box {\n        position: relative;\n        border: 1px solid black;\n        max-width: 50%;\n        padding: 4px;\n        margin: 4px;\n      }\n    </style>\n  </head>\n  <body>\n    <header>\n      Header content\n    </header>\n    <main>\n      <h1>Heading level 1</h1>\n\n      <p>Before section 1</p>\n\n      <div id="section1" data-section="Section 1">\n        <div id="section1-content" data-comment-inline>\n          ðŸ‘‰  Content for section 1\n        </div>\n      </div>\n\n      <p>After section 1</p>\n\n      <h2>Heading for section 2</h2>\n\n      <p>Content before section 2 reviewables</p>\n\n      <div id="section2" data-comment-section="Section 2">\n        <div id="field1" data-comment-inline>\n          ðŸ‘‰ <strong>Rich</strong> content for <a href="#section2">section 2</a>. Lorem ipsum\n          dolor sit amet, consectetur adipiscing elit. Donec nec sapien dolor.\n          Suspendisse sed erat vehicula tortor porta tincidunt at eget dui. Quisque nibh\n          leo, auctor id odio nec, viverra vestibulum mauris. Vestibulum eu aliquet ipsum.\n          Pellentesque interdum dignissim lorem, sit amet dictum velit.\n        </div>\n\n        <div id="field2" data-comment-block>\n          This is content that can be block-commented on\n        </div>\n\n        <div id="field3" data-comment-block>\n          This is additional content that can be block-commented on. Donec nec sapien dolor.\n          Suspendisse sed erat vehicula tortor porta tincidunt at eget dui.\n        </div>\n\n        <div id="field4" data-comment-block>\n          This is even more content that can be block-commented on. Quisque nibh\n          leo, auctor id odio nec, viverra vestibulum mauris. Vestibulum eu aliquet ipsum.\n          Pellentesque interdum dignissim lorem, sit amet dictum velit.\n        </div>\n      </div>\n\n      <p>Content after section 2 reviewables</p>\n\n      <h3 id="heading2-1" data-comment-block>Heading for subsection 2.1</h3>\n\n      <div id="section2-1" data-comment-section="Subsection 2.1" data-comment-section-level="1">\n        <div id="field5" data-comment-inline>\n          Aliquam scelerisque mauris non aliquet iaculis. Nullam egestas urna risus,\n          nec sodales nisl facilisis sed. Duis vitae velit sed ipsum consectetur blandit\n          ut at diam. Vivamus pretium erat non enim hendrerit, id auctor metus lobortis.\n          Suspendisse tellus dui, ullamcorper vel laoreet et, condimentum ut justo. Nunc\n          in tortor non arcu suscipit vestibulum at nec neque. Vivamus fringilla velit arcu,\n          in hendrerit turpis dignissim vel. Duis imperdiet lobortis tortor non ultrices.\n          Cras pretium dui a turpis condimentum, sit amet sollicitudin diam auctor. In porta\n          neque sit amet turpis tempus egestas.\n        </div>\n      </div>\n\n      <h3>Heading for subsection 2.2</h3>\n\n      <div id="section2-2" data-comment-section="Subsection 2.2" data-comment-section-level="1">\n        <div id="field6" data-comment-inline>\n          <p>Aliquam scelerisque mauris non aliquet iaculis. Nullam egestas urna risus,\n          nec sodales nisl facilisis sed. Duis vitae velit sed ipsum consectetur blandit\n          ut at diam. Vivamus pretium erat non enim hendrerit, id auctor metus lobortis.</p>\n\n          <p>Suspendisse tellus dui, ullamcorper vel laoreet et, condimentum ut justo. Nunc\n          in tortor non arcu suscipit vestibulum at nec neque.</p>\n\n          <ul>\n            <li>Curabitur vel turpis nec odio consequat vulputate ac non enim.</li>\n            <li>Ut pulvinar lacus id ipsum maximus convallis.</li>\n            <li>Etiam mattis nibh eu sollicitudin hendrerit.</li>\n            <li>Cras convallis ipsum at risus suscipit sodales.</li>\n            <li>Proin sit amet turpis mattis nunc sagittis dapibus.</li>\n          </ul>\n\n          <p>Vivamus fringilla velit arcu,\n          in hendrerit turpis dignissim vel. Duis imperdiet lobortis tortor non ultrices.\n          Cras pretium dui a turpis condimentum, sit amet sollicitudin diam auctor. In porta\n          neque sit amet turpis tempus egestas.</p>\n        </div>\n      </div>\n\n      <h2>Heading for section 3</h2>\n\n      <div id="section3" data-comment-section="Section 3">\n        <div id="field7" data-comment-inline>\n          Aliquam scelerisque mauris non aliquet iaculis. Nullam egestas urna risus,\n          nec sodales nisl facilisis sed. Duis vitae velit sed ipsum consectetur blandit\n          ut at diam. Vivamus pretium erat non enim hendrerit, id auctor metus lobortis.\n          Suspendisse tellus dui, ullamcorper vel laoreet et, condimentum ut justo. Nunc\n          in tortor non arcu suscipit vestibulum at nec neque. Vivamus fringilla velit arcu,\n          in hendrerit turpis dignissim vel. Duis imperdiet lobortis tortor non ultrices.\n          Cras pretium dui a turpis condimentum, sit amet sollicitudin diam auctor. In porta\n          neque sit amet turpis tempus egestas.\n        </div>\n\n        <p>\n          Each li in the below are a separate field with data-comment-block\n          and some document-specific styles to wrap contents in a relative\n          position box.\n        </p>\n\n        <ul>\n          <li class="box" id="field8" data-comment-block>Curabitur vel turpis nec odio consequat vulputate ac non enim.</li>\n          <li class="box" id="field9" data-comment-block>Ut pulvinar lacus id ipsum maximus convallis.</li>\n          <li class="box" id="field10" data-comment-block>Etiam mattis nibh eu sollicitudin hendrerit.</li>\n          <li class="box" id="field11" data-comment-block>Cras convallis ipsum at risus suscipit sodales.</li>\n          <li class="box" id="field12" data-comment-block>Proin sit amet turpis mattis nunc sagittis dapibus.</li>\n        </ul>\n      </div>\n\n      <h2>Heading for section 4</h2>\n\n      <div id="section4" data-comment-section="Section 4">\n        <div id="field13" data-comment-inline>\n          Aliquam scelerisque mauris non aliquet iaculis. Nullam egestas urna risus,\n          nec sodales nisl facilisis sed. Duis vitae velit sed ipsum consectetur blandit\n          ut at diam. Vivamus pretium erat non enim hendrerit, id auctor metus lobortis.\n          Suspendisse tellus dui, ullamcorper vel laoreet et, condimentum ut justo. Nunc\n          in tortor non arcu suscipit vestibulum at nec neque. Vivamus fringilla velit arcu,\n          in hendrerit turpis dignissim vel. Duis imperdiet lobortis tortor non ultrices.\n          Cras pretium dui a turpis condimentum, sit amet sollicitudin diam auctor. In porta\n          neque sit amet turpis tempus egestas.\n        </div>\n      </div>\n    </main>\n    <footer>\n      Footer content\n    </footer>\n  </body>\n</html>\n',demoAgent={type:"Person",id:"0123456",name:"Chase",email:"mcmanning.1@osu.edu",nickname:"mcmanning.1"},Simple={render:args=>(0,jsx_runtime.jsx)(AnnotationsProvider,{documentId:"mock-document",initialItems:shortFormAnnotations,agent:demoAgent,role:"Reviewer",children:(0,jsx_runtime.jsx)(ExternalDocument,{content:args.content})}),args:{content:demoContent}},AlignmentTest={render:args=>(0,jsx_runtime.jsxs)(AnnotationsProvider,{documentId:"mock-document",initialItems:shortFormAnnotations,agent:demoAgent,role:"Reviewer",children:[(0,jsx_runtime.jsxs)(index_module.Kq,{align:"stretch",children:[(0,jsx_runtime.jsx)(index_module.X6,{level:1,children:"Heading 1"}),(0,jsx_runtime.jsx)(index_module.Xk,{bgc:"aqua",c:"aqua-contrast",p:"sm",children:"Some heading content"})]}),(0,jsx_runtime.jsxs)(index_module.ZA,{children:[(0,jsx_runtime.jsx)(index_module.Xk,{bgc:"blue",c:"blue-contrast",miw:400,h:500,p:"sm",children:"Some aside content"}),(0,jsx_runtime.jsx)(ExternalDocument,{content:args.content})]})]}),args:{content:demoContent}},StressTest={render:args=>{const fields=[...Array(100)].map(((_,i)=>`\n      <div>\n        <strong>Long field ${i}><strong>\n        <div id="field${i}" data-comment-inline>\n          <p>Aliquam scelerisque mauris non aliquet iaculis. Nullam egestas urna risus,\n          nec sodales nisl facilisis sed. Duis vitae velit sed ipsum consectetur blandit\n          ut at diam. Vivamus pretium erat non enim hendrerit, id auctor metus lobortis.</p>\n\n          <p>Suspendisse tellus dui, ullamcorper vel laoreet et, condimentum ut justo. Nunc\n          in tortor non arcu suscipit vestibulum at nec neque.</p>\n\n          <ul>\n            <li>Curabitur vel turpis nec odio consequat vulputate ac non enim.</li>\n            <li>Ut pulvinar lacus id ipsum maximus convallis.</li>\n            <li>Etiam mattis nibh eu sollicitudin hendrerit.</li>\n            <li>Cras convallis ipsum at risus suscipit sodales.</li>\n            <li>Proin sit amet turpis mattis nunc sagittis dapibus.</li>\n          </ul>\n\n          <p>Vivamus fringilla velit arcu,\n          in hendrerit turpis dignissim vel. Duis imperdiet lobortis tortor non ultrices.\n          Cras pretium dui a turpis condimentum, sit amet sollicitudin diam auctor. In porta\n          neque sit amet turpis tempus egestas.</p>\n        </div>\n      </div>\n    `));return(0,jsx_runtime.jsx)(AnnotationsProvider,{documentId:"mock-document",initialItems:annotations,agent:demoAgent,role:"Reviewer",children:(0,jsx_runtime.jsx)(ExternalDocument,{...args,content:`\n          <!DOCTYPE html>\n          <html>\n            <head>\n              <style>\n                * {\n                  color: purple !important;\n                }\n                h1 {\n                  color: green !important;\n                }\n              </style>\n            </head>\n            <body>\n              <header>\n                Header content\n              </header>\n              <main>\n                <h1>Heading level 1</h1>\n                ${fields.join("")}\n              </main>\n              <footer>\n                Footer content\n              </footer>\n            </body>\n          </html>\n          `})})}};Simple.parameters={...Simple.parameters,docs:{...Simple.parameters?.docs,source:{originalSource:'{\n  render: args => <AnnotationsProvider documentId="mock-document" initialItems={shortFormAnnotations} agent={demoAgent} role="Reviewer">\n      <ExternalDocument content={args.content} />\n    </AnnotationsProvider>,\n  args: {\n    content: demoContent\n  }\n}',...Simple.parameters?.docs?.source}}},AlignmentTest.parameters={...AlignmentTest.parameters,docs:{...AlignmentTest.parameters?.docs,source:{originalSource:'{\n  render: args => <AnnotationsProvider documentId="mock-document" initialItems={shortFormAnnotations} agent={demoAgent} role="Reviewer">\n      <Stack align="stretch">\n        <Heading level={1}>Heading 1</Heading>\n        <Paper bgc="aqua" c="aqua-contrast" p="sm">Some heading content</Paper>\n      </Stack>\n      <Group>\n        <Paper bgc="blue" c="blue-contrast" miw={400} h={500} p="sm">\n          Some aside content\n        </Paper>\n        <ExternalDocument content={args.content} />\n      </Group>\n    </AnnotationsProvider>,\n  args: {\n    content: demoContent\n  }\n}',...AlignmentTest.parameters?.docs?.source}}},StressTest.parameters={...StressTest.parameters,docs:{...StressTest.parameters?.docs,source:{originalSource:'{\n  render: args => {\n    const fields = [...Array(100)].map((_, i) => `\n      <div>\n        <strong>Long field ${i}><strong>\n        <div id="field${i}" data-comment-inline>\n          <p>Aliquam scelerisque mauris non aliquet iaculis. Nullam egestas urna risus,\n          nec sodales nisl facilisis sed. Duis vitae velit sed ipsum consectetur blandit\n          ut at diam. Vivamus pretium erat non enim hendrerit, id auctor metus lobortis.</p>\n\n          <p>Suspendisse tellus dui, ullamcorper vel laoreet et, condimentum ut justo. Nunc\n          in tortor non arcu suscipit vestibulum at nec neque.</p>\n\n          <ul>\n            <li>Curabitur vel turpis nec odio consequat vulputate ac non enim.</li>\n            <li>Ut pulvinar lacus id ipsum maximus convallis.</li>\n            <li>Etiam mattis nibh eu sollicitudin hendrerit.</li>\n            <li>Cras convallis ipsum at risus suscipit sodales.</li>\n            <li>Proin sit amet turpis mattis nunc sagittis dapibus.</li>\n          </ul>\n\n          <p>Vivamus fringilla velit arcu,\n          in hendrerit turpis dignissim vel. Duis imperdiet lobortis tortor non ultrices.\n          Cras pretium dui a turpis condimentum, sit amet sollicitudin diam auctor. In porta\n          neque sit amet turpis tempus egestas.</p>\n        </div>\n      </div>\n    `);\n    return <AnnotationsProvider documentId="mock-document" initialItems={annotations} agent={demoAgent} role="Reviewer">\n        <ExternalDocument {...args} content={`\n          <!DOCTYPE html>\n          <html>\n            <head>\n              <style>\n                * {\n                  color: purple !important;\n                }\n                h1 {\n                  color: green !important;\n                }\n              </style>\n            </head>\n            <body>\n              <header>\n                Header content\n              </header>\n              <main>\n                <h1>Heading level 1</h1>\n                ${fields.join(\'\')}\n              </main>\n              <footer>\n                Footer content\n              </footer>\n            </body>\n          </html>\n          `} />\n      </AnnotationsProvider>;\n  }\n}',...StressTest.parameters?.docs?.source}}};const __namedExportsOrder=["Simple","AlignmentTest","StressTest"]}}]);
//# sourceMappingURL=src-components-ExternalDocument-ExternalDocument-stories.59d01060.iframe.bundle.js.map